<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; ZoneMinder  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/zmstyle.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FAQ" href="faq.html" />
    <link rel="prev" title="Configuration Files" href="userguide/configfiles.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ZoneMinder
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installationguide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-wrappers">API Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-evolution">API evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enabling-api">Enabling API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enabling-secret-key">Enabling secret key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-an-api-key">Getting an API key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-these-keys-with-subsequent-requests">Using these keys with subsequent requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-lifetime-v1-0">Key lifetime (v1.0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-lifetime-v2-0">Key lifetime (v2.0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-access-refresh-tokens-v2-0">Understanding access/refresh tokens (v2.0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-key-security">Understanding key security</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-version">API Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-a-list-of-all-monitors">Return a list of all monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#retrieve-monitor-1">Retrieve monitor 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#change-state-of-monitor-1">Change State of Monitor 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-daemon-status-of-monitor-1">Get Daemon Status of Monitor 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-a-monitor">Add a monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#edit-monitor-1">Edit monitor 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete-monitor-1">Delete monitor 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arm-disarm-monitors">Arm/Disarm monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-a-list-of-all-events">Return a list of all events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#retrieve-event-id-1000">Retrieve event Id 1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="#edit-event-1">Edit event 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete-event-1">Delete event 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-a-list-of-events-for-a-specific-monitor-id-5">Return a list of events for a specific monitor Id =5</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-a-list-of-events-for-a-specific-monitor-within-a-specific-date-time-range">Return a list of events for a specific monitor within a specific date/time range</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-a-list-of-events-for-all-monitors-within-a-specified-date-time-range">Return a list of events for all monitors within a specified date/time range</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-event-count-based-on-times-and-conditions">Return event count based on times and conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#return-sorted-events">Return sorted events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-apis">Configuration Apis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-state-apis">Run State Apis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-zone">Create a Zone</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ptz-control-meta-data-apis">PTZ Control Meta-Data APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#host-apis">Host APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storage-and-server-apis">Storage and Server APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-apis">Other APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#streaming-interface">Streaming Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#live-streams">Live Streams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ptz-on-live-streams">PTZ on live streams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pre-recorded-past-event-streams">Pre-recorded (past event) streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-other-parameters-are-supported">What other parameters are supported?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ZoneMinder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading"></a></h1>
<p>This document will provide an overview of ZoneMinder’s API.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>In an effort to further ‘open up’ ZoneMinder, an API was needed.  This will
allow quick integration with and development of ZoneMinder.</p>
<p>The API is built in CakePHP and lives under the <code class="docutils literal notranslate"><span class="pre">/api</span></code> directory.  It
provides a RESTful service and supports CRUD (create, retrieve, update, delete)
functions for Monitors, Events, Frames, Zones and Config.</p>
</section>
<section id="api-wrappers">
<h2>API Wrappers<a class="headerlink" href="#api-wrappers" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>pyzm is a python wrapper for the ZoneMinder APIs. It supports both the legacy and new token based API, as well as ZM logs/ZM shared memory support. See <a class="reference external" href="https://github.com/pliablepixels/pyzm/">its project site</a> for more details. Documentation is <a class="reference external" href="https://pyzm.readthedocs.io/en/latest/">here</a>.</p></li>
</ul>
</section>
<section id="api-evolution">
<h2>API evolution<a class="headerlink" href="#api-evolution" title="Permalink to this heading"></a></h2>
<p>The ZoneMinder API has evolved over time. Broadly speaking the iterations were as follows:</p>
<ul class="simple">
<li><p>Prior to version 1.29, there really was no API layer. Users had to use the same URLs that the web console used to ‘mimic’ operations, or use an XML skin</p></li>
<li><p>Starting version 1.29, a v1.0 CakePHP based API was released which continues to evolve over time. From a security perspective, it still tied into ZM auth and required client cookies for many operations. Primarily, two authentication modes were offered:</p>
<ul>
<li><p>You use cookies to maintain session state (<code class="docutils literal notranslate"><span class="pre">ZM_SESS_ID</span></code>)</p></li>
<li><p>You use an authentication hash to validate yourself, which included encoding personal information and time stamps which at times caused timing validation issues, especially for mobile consumers</p></li>
</ul>
</li>
<li><p>Starting version 1.34, ZoneMinder has introduced a new “token” based system which is based JWT. We have given it a ‘2.0’ version ID. These tokens don’t encode any personal data and can be statelessly passed around per request. It introduces concepts like access tokens, refresh tokens and per user level API revocation to manage security better. The internal components of ZoneMinder all support this new scheme now and if you are using the APIs we strongly recommend you migrate to 1.34 and use this new token system (as a side note, 1.34 also moves from MYSQL PASSWORD to Bcrypt for passwords, which is also a good reason why you should migate).</p></li>
<li><p>Note that as of 1.34, both versions of API access will work (tokens and the older auth hash mechanism), however we no longer use sessions by default.  You will have to add a <code class="docutils literal notranslate"><span class="pre">stateful=1</span></code> query parameter during login to tell ZM to set a COOKIE and store the required info in the session. This option is only available if <code class="docutils literal notranslate"><span class="pre">OPT_USE_LEGACY_API_AUTH</span></code> is set to ON.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the rest of the document, we will specifically highlight v2.0 only features. If you don’t see a special mention, assume it applies for both API versions.</p>
</div>
</section>
<section id="enabling-api">
<h2>Enabling API<a class="headerlink" href="#enabling-api" title="Permalink to this heading"></a></h2>
<p>ZoneMinder comes with APIs enabled. To check if APIs are enabled, visit <code class="docutils literal notranslate"><span class="pre">Options-&gt;System</span></code>. If <code class="docutils literal notranslate"><span class="pre">OPT_USE_API</span></code> is enabled, your APIs are active.
For v2.0 APIs, you have an additional option right below it:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OPT_USE_LEGACY_API_AUTH</span></code> which is enabled by default. When enabled, the <cite>login.json</cite> API (discussed later) will return both the old style (<code class="docutils literal notranslate"><span class="pre">auth=</span></code>) and new style (<code class="docutils literal notranslate"><span class="pre">token=</span></code>) credentials. The reason this is enabled by default is because any existing apps that use the API would break if they were not updated to use v2.0. (Note that zmNinja 1.3.057 and beyond will support tokens)</p></li>
</ul>
</div></blockquote>
</section>
<section id="enabling-secret-key">
<h2>Enabling secret key<a class="headerlink" href="#enabling-secret-key" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>It is <strong>important</strong> that you create a “Secret Key”. This needs to be a set of hard to guess characters, that only you know. ZoneMinder does not create a key for you. It is your responsibility to create it. If you haven’t created one already, please do so by going to <code class="docutils literal notranslate"><span class="pre">Options-&gt;Systems</span></code> and populating <code class="docutils literal notranslate"><span class="pre">AUTH_HASH_SECRET</span></code>. Don’t forget to save.</p></li>
<li><p>If you plan on using V2.0 token based security, <strong>it is mandatory to populate this secret key</strong>, as it is used to sign the token. If you don’t, token authentication will fail. V1.0 did not mandate this requirement.</p></li>
</ul>
</section>
<section id="getting-an-api-key">
<h2>Getting an API key<a class="headerlink" href="#getting-an-api-key" title="Permalink to this heading"></a></h2>
<p>To get an API key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;user=yourusername&amp;pass=yourpassword&quot;</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">yourserver</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>If you want to use a stateful connection, so you don’t have to pass auth credentials with each query, you can use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="o">-</span><span class="n">c</span> <span class="n">cookies</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;user=yourusername&amp;pass=yourpassword&amp;stateful=1&quot;</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">yourserver</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>This returns a payload like this for API v1.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;auth=05f3a50e8f7&lt;deleted&gt;063&quot;</span><span class="p">,</span>
    <span class="s2">&quot;append_password&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.33.9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apiversion&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Or for API 2.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJK&lt;deleted&gt;HE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;access_token_expires&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOi&lt;deleted&gt;mPs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;refresh_token_expires&quot;</span><span class="p">:</span> <span class="mi">86400</span><span class="p">,</span>
    <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;auth=05f3a50e8f7&lt;deleted&gt;063&quot;</span><span class="p">,</span>  <span class="c1"># only if OPT_USE_LEGACY_API_AUTH is enabled</span>
    <span class="s2">&quot;append_password&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># only if OPT_USE_LEGACY_API_AUTH is enabled</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.33.9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apiversion&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="using-these-keys-with-subsequent-requests">
<h2>Using these keys with subsequent requests<a class="headerlink" href="#using-these-keys-with-subsequent-requests" title="Permalink to this heading"></a></h2>
<p>Once you have the keys (a.k.a credentials (v1.0, v2.0) or token (v2.0)) you should now supply that key to subsequent API calls like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># v1.0 or 2.0 based API access (will only work if AUTH_HASH_LOGINS is enabled

# RECOMMENDED: v2.0 token based
  curl -XGET  https://yourserver/zm/api/monitors.json?token=&lt;access_token&gt;

# or, for legacy mode:

curl -XGET  https://yourserver/zm/api/monitors.json?auth=&lt;hex digits from &#39;credentials&#39;&gt;

# or, if you specified -c cookies.txt in the original login request

curl -b cookies.txt -XGET   https://yourserver/zm/api/monitors.json
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using an <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">GET</span></code> request, the token/auth needs to be passed as a query parameter in the URL. If you are using an <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">POST</span></code> (like when you use the API to modify a monitor, for example), you can choose to pass the token as a data payload instead. The API layer discards data payloads for <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">GET</span></code>. Finally, If you don’t pass keys, you could also use cookies (not recommended as a general approach).</p>
</div>
</section>
<section id="key-lifetime-v1-0">
<h2>Key lifetime (v1.0)<a class="headerlink" href="#key-lifetime-v1-0" title="Permalink to this heading"></a></h2>
<p>If you are using the old credentials mechanism present in v1.0, then the credentials will time out based on PHP session timeout (if you are using cookies), or the value of <code class="docutils literal notranslate"><span class="pre">AUTH_HASH_TTL</span></code> (if you are using <code class="docutils literal notranslate"><span class="pre">auth=</span></code> and have enabled <code class="docutils literal notranslate"><span class="pre">AUTH_HASH_LOGINS</span></code>) which defaults to 2 hours.  Note that there is no way to look at the hash and decipher how much time is remaining. So it is your responsibility to record the time you got the hash and assume it was generated at the time you got it and re-login before that time expires.</p>
</section>
<section id="key-lifetime-v2-0">
<h2>Key lifetime (v2.0)<a class="headerlink" href="#key-lifetime-v2-0" title="Permalink to this heading"></a></h2>
<p>In version 2.0, it is easy to know when a key will expire before you use it. You can find that out from the <code class="docutils literal notranslate"><span class="pre">access_token_expires</span></code> and <code class="docutils literal notranslate"><span class="pre">refresh_token_expires</span></code> values (in seconds) after you decode the JWT key (there are JWT decode libraries for every language you want). You should refresh the keys before the timeout occurs, or you will not be able to use the APIs.</p>
</section>
<section id="understanding-access-refresh-tokens-v2-0">
<h2>Understanding access/refresh tokens (v2.0)<a class="headerlink" href="#understanding-access-refresh-tokens-v2-0" title="Permalink to this heading"></a></h2>
<p>If you are using V2.0, then you need to know how to use these tokens effectively:</p>
<ul class="simple">
<li><p>Access tokens are short lived. ZoneMinder issues access tokens that live for 3600 seconds (1 hour).</p></li>
<li><p>Access tokens should be used for all subsequent API accesses.</p></li>
<li><p>Refresh tokens should ONLY be used to generate new access tokens. For example, if an access token lives for 1 hour, before the hour completes, invoke the <code class="docutils literal notranslate"><span class="pre">login.json</span></code> API above with the refresh token to get a new access token. ZoneMinder issues refresh tokens that live for 24 hours.</p></li>
<li><p>To generate a new refresh token before 24 hours are up, you will need to pass your user login and password to <code class="docutils literal notranslate"><span class="pre">login.json</span></code></p></li>
</ul>
<p><strong>To Summarize:</strong></p>
<ul class="simple">
<li><p>Pass your <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code> to <code class="docutils literal notranslate"><span class="pre">login.json</span></code> only once in 24 hours to renew your tokens</p></li>
<li><p>Pass your “refresh token” to <code class="docutils literal notranslate"><span class="pre">login.json</span></code> once in two hours (or whatever you have set the value of <code class="docutils literal notranslate"><span class="pre">AUTH_HASH_TTL</span></code> to) to renew your <code class="docutils literal notranslate"><span class="pre">access</span> <span class="pre">token</span></code></p></li>
<li><p>Use your <code class="docutils literal notranslate"><span class="pre">access</span> <span class="pre">token</span></code> for all API invocations.</p></li>
</ul>
<p>In fact, V2.0 will reject your request (if it is not to <code class="docutils literal notranslate"><span class="pre">login.json</span></code>) if it comes with a refresh token instead of an access token to discourage usage of this token when it should not be used.</p>
<p>This minimizes the amount of sensitive data that is sent over the wire and the lifetime durations are made so that if they get compromised, you can regenerate or invalidate them (more on this later)</p>
</section>
<section id="understanding-key-security">
<h2>Understanding key security<a class="headerlink" href="#understanding-key-security" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Version 1.0 uses an MD5 hash to generate the credentials. The hash is computed over your secret key (if available), username, password and some time parameters (along with remote IP if enabled). This is not a secure/recommended hashing mechanism. If your auth hash is compromised, an attacker will be able to use your hash till it expires. To avoid this, you could disable the user in ZoneMinder. Furthermore, enabling remote IP (<code class="docutils literal notranslate"><span class="pre">AUTH_HASH_REMOTE_IP</span></code>) requires that you issue future requests from the same IP that generated the tokens. While this may be considered an additional layer for security, this can cause issues with mobile devices.</p></li>
<li><p>Version 2.0 uses a different approach. The hash is a simple base64 encoded form of “claims”, but signed with your secret key. Consider for example, the following access key:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><span class="o">.</span><span class="n">eyJpc3MiOiJab25lTWluZGVyIiwiaWF0IjoxNTU3OTQwNzUyLCJleHAiOjE1NTc5NDQzNTIsInVzZXIiOiJhZG1pbiIsInR5cGUiOiJhY2Nlc3MifQ</span><span class="o">.-</span><span class="mi">5</span><span class="n">VOcpw3cFHiSTN5zfGDSrrPyVya1M8_2Anh5u6eNlI</span>
</pre></div>
</div>
<p>If you were to use any <a class="reference external" href="https://jwt.io">JWT token verifier</a> it can easily decode that token and will show:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;iss&quot;</span><span class="p">:</span> <span class="s2">&quot;ZoneMinder&quot;</span><span class="p">,</span>
<span class="s2">&quot;iat&quot;</span><span class="p">:</span> <span class="mi">1557940752</span><span class="p">,</span>
<span class="s2">&quot;exp&quot;</span><span class="p">:</span> <span class="mi">1557944352</span><span class="p">,</span>
<span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;access&quot;</span>
<span class="p">}</span>
<span class="n">Invalid</span> <span class="n">Signature</span>
</pre></div>
</div>
<p>Don’t be surprised. JWT tokens, by default, are <a class="reference external" href="https://softwareengineering.stackexchange.com/questions/280257/json-web-token-why-is-the-payload-public">not meant to be encrypted</a>. It is just an assertion of a claim. It states that the issuer of this token was ZoneMinder,
It was issued at (iat) Wednesday, 2019-05-15 17:19:12 UTC and will expire on (exp) Wednesday, 2019-05-15 18:19:12 UTC. This token claims to be owned by an admin and is an access token. If your token were to be stolen, this information is available to the person who stole it. Note that there are no sensitive details like passwords in this claim.</p>
<p>However, that person will <strong>not</strong> have your secret key as part of this token and therefore, will NOT be able to create a new JWT token to get, say, a refresh token. They will however, be able to use your access token to access resources just like the auth hash above, till the access token expires (2 hrs). To revoke this token, you don’t need to disable the user. Go to <code class="docutils literal notranslate"><span class="pre">Options-&gt;API</span></code> and tap on “Revoke All Access Tokens”. This will invalidate the token immediately (this option will invalidate all tokens for all users, and new ones will need to be generated).</p>
<p>Over time, we will provide you with more fine grained access to these options.</p>
<p><strong>Summarizing good practices:</strong></p>
<ul class="simple">
<li><p>Use HTTPS, not HTTP</p></li>
<li><p>If possible, use free services like <a class="reference external" href="https://letsencrypt.org">LetsEncrypt</a> instead of self-signed certificates (sometimes this is not possible)</p></li>
<li><p>Keep your tokens as private as possible, and use them as recommended above</p></li>
<li><p>If you believe your tokens are compromised, revoke them, but also check if your attacker has compromised more than you think (example, they may also have your username/password or access to your system via other exploits, in which case they can regenerate as many tokens/credentials as they want).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Subsequent sections don’t explicitly callout the key addition to APIs. We assume that you will append the correct keys as per our explanation above.</p>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>(In all examples, replace ‘server’ with IP or hostname &amp; port where ZoneMinder is running)</p>
</section>
<section id="api-version">
<h2>API Version<a class="headerlink" href="#api-version" title="Permalink to this heading"></a></h2>
<p>To retrieve the API version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">getVersion</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="return-a-list-of-all-monitors">
<h2>Return a list of all monitors<a class="headerlink" href="#return-a-list-of-all-monitors" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>It is worthwhile to note that starting ZM 1.32.3 and beyond, this API also returns a <code class="docutils literal notranslate"><span class="pre">Monitor_Status</span></code> object per monitor. It looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Monitor_Status&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;MonitorId&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="s2">&quot;Connected&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CaptureFPS&quot;</span><span class="p">:</span> <span class="s2">&quot;1.67&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AnalysisFPS&quot;</span><span class="p">:</span> <span class="s2">&quot;1.67&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CaptureBandwidth&quot;</span><span class="p">:</span> <span class="s2">&quot;52095&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>If you don’t see this in your API, you are running an older version of ZM. This gives you a very convenient way to check monitor status without calling the <code class="docutils literal notranslate"><span class="pre">daemonCheck</span></code> API described later.</p>
</section>
<section id="retrieve-monitor-1">
<h2>Retrieve monitor 1<a class="headerlink" href="#retrieve-monitor-1" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="change-state-of-monitor-1">
<h2>Change State of Monitor 1<a class="headerlink" href="#change-state-of-monitor-1" title="Permalink to this heading"></a></h2>
<p>This API changes monitor 1 to enable motion detection and recording on motion detection (similar to old Modect function)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Monitor[Analysing]=Always&amp;Monitor[Recording]=OnMotion&quot;</span>
</pre></div>
</div>
</section>
<section id="get-daemon-status-of-monitor-1">
<h2>Get Daemon Status of Monitor 1<a class="headerlink" href="#get-daemon-status-of-monitor-1" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="n">daemonStatus</span><span class="o">/</span><span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">daemon</span><span class="p">:</span><span class="n">zmc</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="add-a-monitor">
<h2>Add a monitor<a class="headerlink" href="#add-a-monitor" title="Permalink to this heading"></a></h2>
<p>This command will add a new http monitor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Monitor[Name]=Cliff-Burton</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Capturing]=Always</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Analysing]=Always</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Recording]=Always</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Protocol]=http</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Method]=simple</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Host]=usr:pass@192.168.11.20</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Port]=80</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Path]=/mjpg/video.mjpg</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Width]=704</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Height]=480</span><span class="se">\</span>
<span class="s2">&amp;Monitor[Colours]=4&quot;</span>
</pre></div>
</div>
</section>
<section id="edit-monitor-1">
<h2>Edit monitor 1<a class="headerlink" href="#edit-monitor-1" title="Permalink to this heading"></a></h2>
<p>This command will change the ‘Name’ field of Monitor 1 to ‘test1’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Monitor[Name]=test1&quot;</span>
</pre></div>
</div>
</section>
<section id="delete-monitor-1">
<h2>Delete monitor 1<a class="headerlink" href="#delete-monitor-1" title="Permalink to this heading"></a></h2>
<p>This command will delete Monitor 1, but will _not_ delete any Events which
depend on it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XDELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="arm-disarm-monitors">
<h2>Arm/Disarm monitors<a class="headerlink" href="#arm-disarm-monitors" title="Permalink to this heading"></a></h2>
<p>This command will force an alarm on Monitor 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="n">alarm</span><span class="o">/</span><span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">command</span><span class="p">:</span><span class="n">on</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>This command will disable the  alarm on Monitor 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="n">alarm</span><span class="o">/</span><span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">command</span><span class="p">:</span><span class="n">off</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>This command will report the status of the alarm  Monitor 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">monitors</span><span class="o">/</span><span class="n">alarm</span><span class="o">/</span><span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">command</span><span class="p">:</span><span class="n">status</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="return-a-list-of-all-events">
<h2>Return a list of all events<a class="headerlink" href="#return-a-list-of-all-events" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Note that events list can be quite large and this API (as with all other APIs in ZM)
uses pagination. Each page returns a specific set of entries. By default this is 25
and ties into WEB_EVENTS_PER_PAGE in the ZM options menu.</p>
<p>So the logic to iterate through all events should be something like this (pseudocode):
(unfortunately there is no way to get pageCount without getting the first page)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>data = http://server/zm/api/events.json?page=1 # this returns the first page
# The json object returned now has a property called data.pagination.pageCount
count = data.pagination.pageCount;
for (i=1, i&lt;count, i++)
{
  data = http://server/zm/api/events.json?page=i;
   doStuff(data);
}
</pre></div>
</div>
</section>
<section id="retrieve-event-id-1000">
<h2>Retrieve event Id 1000<a class="headerlink" href="#retrieve-event-id-1000" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">/</span><span class="mf">1000.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="edit-event-1">
<h2>Edit event 1<a class="headerlink" href="#edit-event-1" title="Permalink to this heading"></a></h2>
<p>This command will change the ‘Name’ field of Event 1 to ‘Seek and Destroy’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Event[Name]=Seek and Destroy&quot;</span>
</pre></div>
</div>
</section>
<section id="delete-event-1">
<h2>Delete event 1<a class="headerlink" href="#delete-event-1" title="Permalink to this heading"></a></h2>
<p>This command will delete Event 1, and any Frames which depend on it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XDELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="return-a-list-of-events-for-a-specific-monitor-id-5">
<h2>Return a list of events for a specific monitor Id =5<a class="headerlink" href="#return-a-list-of-events-for-a-specific-monitor-id-5" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">/</span><span class="n">index</span><span class="o">/</span><span class="n">MonitorId</span><span class="p">:</span><span class="mf">5.</span><span class="n">json</span>
</pre></div>
</div>
<p>Note that the same pagination logic applies if the list is too long</p>
</section>
<section id="return-a-list-of-events-for-a-specific-monitor-within-a-specific-date-time-range">
<h2>Return a list of events for a specific monitor within a specific date/time range<a class="headerlink" href="#return-a-list-of-events-for-a-specific-monitor-within-a-specific-date-time-range" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">events</span><span class="o">/</span><span class="n">index</span><span class="o">/</span><span class="n">MonitorId</span><span class="p">:</span><span class="mi">5</span><span class="o">/</span><span class="n">StartTime</span> <span class="o">&gt;=</span><span class="p">:</span><span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">18</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">56</span><span class="o">/</span><span class="n">EndTime</span> <span class="o">&lt;=</span><span class="p">:</span><span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">16</span> <span class="mi">18</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mf">56.</span><span class="n">json</span>
</pre></div>
</div>
<p>To try this in CuRL, you need to URL escape the spaces like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span>  <span class="s2">&quot;http://server/zm/api/events/index/MonitorId:5/StartTime%20&gt;=:2015-05-15%2018:43:56/EndTime%20&lt;=:2015-05-16%2018:43:56.json&quot;</span>
</pre></div>
</div>
</section>
<section id="return-a-list-of-events-for-all-monitors-within-a-specified-date-time-range">
<h2>Return a list of events for all monitors within a specified date/time range<a class="headerlink" href="#return-a-list-of-events-for-all-monitors-within-a-specified-date-time-range" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="s2">&quot;http://server/zm/api/events/index/StartTime%20&gt;=:2015-05-15%2018:43:56/EndTime%20&lt;=:208:43:56.json&quot;</span>
</pre></div>
</div>
</section>
<section id="return-event-count-based-on-times-and-conditions">
<h2>Return event count based on times and conditions<a class="headerlink" href="#return-event-count-based-on-times-and-conditions" title="Permalink to this heading"></a></h2>
<p>The API also supports a handy mechanism to return a count of events for a period of time.</p>
<p>This returns number of events per monitor that were recorded in the last one hour</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s2">&quot;http://server/zm/api/events/consoleEvents/1</span><span class="si">%20ho</span><span class="s2">ur.json&quot;</span>
</pre></div>
</div>
<p>This returns number of events per monitor that were recorded in the last day where there were at least 10 frames that were alarms”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s2">&quot;http://server/zm/api/events/consoleEvents/1</span><span class="si">%20d</span><span class="s2">ay.json/AlarmFrames &gt;=: 10.json&quot;</span>
</pre></div>
</div>
</section>
<section id="return-sorted-events">
<h2>Return sorted events<a class="headerlink" href="#return-sorted-events" title="Permalink to this heading"></a></h2>
<p>This returns a list of events within a time range and also sorts it by descending order</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="s2">&quot;http://server/zm/api/events/index/StartTime%20&gt;=:2015-05-15%2018:43:56/EndTime%20&lt;=:208:43:56.json?sort=StartTime&amp;direction=desc&quot;</span>
</pre></div>
</div>
</section>
<section id="configuration-apis">
<h2>Configuration Apis<a class="headerlink" href="#configuration-apis" title="Permalink to this heading"></a></h2>
<p>The APIs allow you to access all the configuration parameters of ZM that you typically set inside the web console.
This returns the full list of configuration parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">configs</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Each configuration parameter has an Id, Name, Value and other fields. Chances are you are likely only going to focus on these 3.</p>
<p>The edit function of the Configs API is a little quirky at the moment. Its format deviates from the usual edit flow of other APIs. This will be fixed, eventually. For now, to change the “Value” of ZM_X10_HOUSE_CODE from A to B:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">edit</span><span class="o">/</span><span class="n">ZM_X10_HOUSE_CODE</span><span class="o">.</span><span class="n">json</span>  <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Config[Value]=B&quot;</span>
</pre></div>
</div>
<p>To validate changes have been made:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">view</span><span class="o">/</span><span class="n">ZM_X10_HOUSE_CODE</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="run-state-apis">
<h2>Run State Apis<a class="headerlink" href="#run-state-apis" title="Permalink to this heading"></a></h2>
<p>ZM API can be used to start/stop/restart/list states of  ZM as well
Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">states</span><span class="o">.</span><span class="n">json</span> <span class="c1"># returns list of run states</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">states</span><span class="o">/</span><span class="n">change</span><span class="o">/</span><span class="n">restart</span><span class="o">.</span><span class="n">json</span> <span class="c1">#restarts ZM</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">states</span><span class="o">/</span><span class="n">change</span><span class="o">/</span><span class="n">stop</span><span class="o">.</span><span class="n">json</span> <span class="c1">#Stops ZM</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">states</span><span class="o">/</span><span class="n">change</span><span class="o">/</span><span class="n">start</span><span class="o">.</span><span class="n">json</span> <span class="c1">#Starts ZM</span>
</pre></div>
</div>
</section>
<section id="create-a-zone">
<h2>Create a Zone<a class="headerlink" href="#create-a-zone" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">zones</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;Zone[Name]=Jason-Newsted</span><span class="se">\</span>
<span class="s2">&amp;Zone[MonitorId]=3</span><span class="se">\</span>
<span class="s2">&amp;Zone[Type]=Active</span><span class="se">\</span>
<span class="s2">&amp;Zone[Units]=Percent</span><span class="se">\</span>
<span class="s2">&amp;Zone[NumCoords]=4</span><span class="se">\</span>
<span class="s2">&amp;Zone[Coords]=0,0 639,0 639,479 0,479</span><span class="se">\</span>
<span class="s2">&amp;Zone[Area]=307200</span><span class="se">\</span>
<span class="s2">&amp;Zone[AlarmRGB]=16711680</span><span class="se">\</span>
<span class="s2">&amp;Zone[CheckMethod]=Blobs</span><span class="se">\</span>
<span class="s2">&amp;Zone[MinPixelThreshold]=25</span><span class="se">\</span>
<span class="s2">&amp;Zone[MaxPixelThreshold]=</span><span class="se">\</span>
<span class="s2">&amp;Zone[MinAlarmPixels]=9216</span><span class="se">\</span>
<span class="s2">&amp;Zone[MaxAlarmPixels]=</span><span class="se">\</span>
<span class="s2">&amp;Zone[FilterX]=3</span><span class="se">\</span>
<span class="s2">&amp;Zone[FilterY]=3</span><span class="se">\</span>
<span class="s2">&amp;Zone[MinFilterPixels]=9216</span><span class="se">\</span>
<span class="s2">&amp;Zone[MaxFilterPixels]=230400</span><span class="se">\</span>
<span class="s2">&amp;Zone[MinBlobPixels]=6144</span><span class="se">\</span>
<span class="s2">&amp;Zone[MaxBlobPixels]=</span><span class="se">\</span>
<span class="s2">&amp;Zone[MinBlobs]=1</span><span class="se">\</span>
<span class="s2">&amp;Zone[MaxBlobs]=</span><span class="se">\</span>
<span class="s2">&amp;Zone[OverloadFrames]=0&quot;</span>
</pre></div>
</div>
</section>
<section id="ptz-control-meta-data-apis">
<h2>PTZ Control Meta-Data APIs<a class="headerlink" href="#ptz-control-meta-data-apis" title="Permalink to this heading"></a></h2>
<p>PTZ controls associated with a monitor are stored in the Controls table and not the Monitors table inside ZM. What that means is when you get the details of a Monitor, you will only know if it is controllable (isControllable:true) and the control ID.
To be able to retrieve PTZ information related to that Control ID, you need to use the controls API</p>
<p>Note that these APIs only retrieve control data related to PTZ. They don’t actually move the camera. See the “PTZ on live streams” section to move the camera.</p>
<p>This returns all the control definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">controls</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>This returns control definitions for a specific control ID=5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">controls</span><span class="o">/</span><span class="mf">5.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="host-apis">
<h2>Host APIs<a class="headerlink" href="#host-apis" title="Permalink to this heading"></a></h2>
<p>ZM APIs have various APIs that help you in determining host (aka ZM) daemon status, load etc. Some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">getLoad</span><span class="o">.</span><span class="n">json</span> <span class="c1"># returns current load of ZM</span>

<span class="c1"># Note that ZM 1.32.3 onwards has the same information in Monitors.json which is more reliable and works for multi-server too.</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">daemonCheck</span><span class="o">.</span><span class="n">json</span> <span class="c1"># 1 = ZM running 0=not running</span>

<span class="c1"># The API below uses &quot;du&quot; to calculate disk space. We no longer recommend you use it if you have many events. Use the Storage APIs instead, described later</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">getDiskPercent</span><span class="o">.</span><span class="n">json</span> <span class="c1"># returns in GB (not percentage), disk usage per monitor (that is,space taken to store various event related information,images etc. per monitor)</span>
</pre></div>
</div>
</section>
<section id="storage-and-server-apis">
<h2>Storage and Server APIs<a class="headerlink" href="#storage-and-server-apis" title="Permalink to this heading"></a></h2>
<p>ZoneMinder introduced many new options that allowed you to configure multiserver/multistorage configurations. While a part of this was available in previous versions, a lot of rework was done as part of ZM 1.31 and 1.32. As part of that work, a lot of new and useful APIs were added. Some of these are part of ZM 1.32 and others will be part of ZM 1.32.3 (of course, if you build from master, you can access them right away, or wait till a stable release is out.</p>
<p>This returns storage data for my single server install. If you are using multi-storage, you’ll see many such “Storage” entries, one for each storage defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">storage</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;storage&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Path&quot;</span><span class="p">:</span> <span class="s2">&quot;\/var\/cache\/zoneminder\/events&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Default&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Url&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
                <span class="s2">&quot;DiskSpace&quot;</span><span class="p">:</span> <span class="s2">&quot;364705447651&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Scheme&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ServerId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
                <span class="s2">&quot;DoDelete&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>“DiskSpace” is the disk used in bytes. While this doesn’t return disk space data as rich as  <code class="docutils literal notranslate"><span class="pre">/host/getDiskPercent</span></code>, it is much more efficient.</p>
<p>Similarly,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">servers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;servers&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
              <span class="s2">&quot;Server&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;server1&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;server1.mydomain.com&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;State_Id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
                  <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="s2">&quot;Running&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;CpuLoad&quot;</span><span class="p">:</span> <span class="s2">&quot;0.9&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;TotalMem&quot;</span><span class="p">:</span> <span class="s2">&quot;6186237952&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;FreeMem&quot;</span><span class="p">:</span> <span class="s2">&quot;156102656&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;TotalSwap&quot;</span><span class="p">:</span> <span class="s2">&quot;536866816&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;FreeSwap&quot;</span><span class="p">:</span> <span class="s2">&quot;525697024&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;zmstats&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                  <span class="s2">&quot;zmaudit&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                  <span class="s2">&quot;zmtrigger&quot;</span><span class="p">:</span> <span class="n">false</span>
              <span class="p">}</span>
          <span class="p">}</span>
      <span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>This only works if you have a multiserver setup in place. If you don’t it will return an empty array.</p>
</section>
<section id="other-apis">
<h2>Other APIs<a class="headerlink" href="#other-apis" title="Permalink to this heading"></a></h2>
<p>This is not a complete list. ZM supports more parameters/APIs. A good way to dive in is to look at the <a class="reference external" href="https://github.com/ZoneMinder/zoneminder/tree/master/web/api/app/Controller">API code</a> directly.</p>
</section>
<section id="streaming-interface">
<h2>Streaming Interface<a class="headerlink" href="#streaming-interface" title="Permalink to this heading"></a></h2>
<p>Developers working on their application often ask if there is an “API” to receive live streams, or recorded event streams.
It is possible to stream both live and recorded streams. This isn’t strictly an “API” per-se (that is, it is not integrated
into the Cake PHP based API layer discussed here) and also why we’ve used the term “Interface” instead of an “API”.</p>
<section id="live-streams">
<h3>Live Streams<a class="headerlink" href="#live-streams" title="Permalink to this heading"></a></h3>
<p>What you need to know is that if you want to display “live streams”, ZoneMinder sends you streaming JPEG images (MJPEG)
which can easily be rendered in a browser using an <code class="docutils literal notranslate"><span class="pre">img</span> <span class="pre">src</span></code> tag.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/cgi-bin/nph-zms?scale=50&amp;width=640p&amp;height=480px&amp;mode=jpeg&amp;maxfps=5&amp;buffer=1000&amp;&amp;monitor=1&amp;token=eW&lt;deleted&gt;03&amp;connkey=36139&quot;</span> <span class="o">/&gt;</span>

<span class="c1"># or</span>

<span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/cgi-bin/nph-zms?scale=50&amp;width=640p&amp;height=480px&amp;mode=jpeg&amp;maxfps=5&amp;buffer=1000&amp;&amp;monitor=1&amp;auth=b5&lt;deleted&gt;03&amp;connkey=36139&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<p>will display a live feed from monitor id 1, scaled down by 50% in quality and resized to 640x480px.</p>
<ul class="simple">
<li><p>This assumes <code class="docutils literal notranslate"><span class="pre">/zm/cgi-bin</span></code> is your CGI_BIN path. Change it to what is correct in your system</p></li>
<li><p>The “auth” token you see above is required if you use ZoneMinder authentication. To understand how to get the auth token, please read the “Login, Logout &amp; API security” section below.</p></li>
<li><p>The “connkey” parameter is essentially a random number which uniquely identifies a stream. If you don’t specify a connkey, ZM will generate its own. It is recommended to generate a connkey because you can then use it to “control” the stream (pause/resume etc.)</p></li>
<li><p>Instead of dealing with the “auth” token, you can also use <code class="docutils literal notranslate"><span class="pre">&amp;user=username&amp;pass=password</span></code> where “username” and “password” are your ZoneMinder username and password respectively. Note that this is not recommended because you are transmitting them in a URL and even if you use HTTPS, they may show up in web server logs.</p></li>
</ul>
<section id="ptz-on-live-streams">
<h4>PTZ on live streams<a class="headerlink" href="#ptz-on-live-streams" title="Permalink to this heading"></a></h4>
<p>PTZ commands are pretty cryptic in ZoneMinder. This is not meant to be an exhaustive guide, but just something to wet your appetite:</p>
<p>Lets assume you have a monitor, with ID=6. Let’s further assume you want to pan it left.</p>
<p>You’d need to send a:
<code class="docutils literal notranslate"><span class="pre">POST</span></code> command to <code class="docutils literal notranslate"><span class="pre">https://yourserver/zm/index.php</span></code> with the following data payload in the command (NOT in the URL)</p>
<p><code class="docutils literal notranslate"><span class="pre">view=request&amp;request=control&amp;id=6&amp;control=moveConLeft&amp;xge=30&amp;yge=30</span></code></p>
<p>Obviously, if you are using authentication, you need to be logged in for this to work.</p>
<p>Like I said, at this stage, this is only meant to get you started. Explore the ZoneMinder code and use “Inspect source” as you use PTZ commands in the ZoneMinder source code.
<a class="reference external" href="https://github.com/ZoneMinder/zoneminder/blob/10531df54312f52f0f32adec3d4720c063897b62/web/skins/classic/includes/control_functions.php">control_functions.php</a> is a great place to start.</p>
</section>
</section>
<section id="pre-recorded-past-event-streams">
<h3>Pre-recorded (past event) streams<a class="headerlink" href="#pre-recorded-past-event-streams" title="Permalink to this heading"></a></h3>
<p>Similar to live playback, if you have chosen to store events in JPEG mode, you can play it back using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/cgi-bin/nph-zms?mode=jpeg&amp;frame=1&amp;replay=none&amp;source=event&amp;event=293820&amp;connkey=77493&amp;token=ew&lt;deleted&gt;&quot;</span> <span class="o">/&gt;</span>

<span class="c1"># or</span>

<span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/cgi-bin/nph-zms?mode=jpeg&amp;frame=1&amp;replay=none&amp;source=event&amp;event=293820&amp;connkey=77493&amp;auth=b5&lt;deleted&gt;&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This assumes <code class="docutils literal notranslate"><span class="pre">/zm/cgi-bin</span></code> is your CGI_BIN path. Change it to what is correct in your system</p></li>
<li><p>This will playback event 293820, starting from frame 1 as an MJPEG stream</p></li>
<li><p>Like before, you can add more parameters like <code class="docutils literal notranslate"><span class="pre">scale</span></code> etc.</p></li>
<li><p>auth and connkey have the same meaning as before, and yes, you can replace auth by <code class="docutils literal notranslate"><span class="pre">&amp;user=usename&amp;pass=password</span></code> as before and the same security concerns cited above apply.</p></li>
</ul>
<p>If instead, you have chosen to use the MP4 (Video) storage mode for events, you can directly play back the saved video file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">video</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/index.php?view=view_video&amp;eid=294690&amp;token=eW&lt;deleted&gt;&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;video/mp4&quot;</span><span class="o">&gt;&lt;/</span><span class="n">video</span><span class="o">&gt;</span>

<span class="c1"># or</span>

<span class="o">&lt;</span><span class="n">video</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://yourserver/zm/index.php?view=view_video&amp;eid=294690&amp;auth=33&lt;deleted&gt;&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;video/mp4&quot;</span><span class="o">&gt;&lt;/</span><span class="n">video</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This above will play back the video recording for event 294690</p>
</section>
<section id="what-other-parameters-are-supported">
<h3>What other parameters are supported?<a class="headerlink" href="#what-other-parameters-are-supported" title="Permalink to this heading"></a></h3>
<p>The best way to answer this question is to play with ZoneMinder console. Open a browser, play back live or recorded feed, and do an “Inspect Source” to see what parameters
are generated. Change and observe.</p>
</section>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading"></a></h2>
<p>As described earlier, treat this document as an “introduction” to the important parts of the API and streaming interfaces.
There are several details that haven’t yet been documented. Till they are, here are some resources:</p>
<ul class="simple">
<li><p>zmNinja, the open source mobile app for ZoneMinder is 100% based on ZM APIs. Explore its <a class="reference external" href="https://github.com/pliablepixels/zmNinja">source code</a> to see how things work.</p></li>
<li><p>Launch up ZM console in a browser, and do an “Inspect source”. See how images are being rendered. Go to the networks tab of the inspect source console and look at network requests that are made when you pause/play/forward streams.</p></li>
<li><p>If you still can’t find an answer, post your question in the <a class="reference external" href="https://forums.zoneminder.com/index.php">forums</a> (not the github repo).</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="userguide/configfiles.html" class="btn btn-neutral float-left" title="Configuration Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014, https://github.com/ZoneMinder/ZoneMinder/graphs/contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>